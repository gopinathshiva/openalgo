import{r as o}from"./vendor-react-CCyQGCED.js";async function h(){return(await(await fetch("/auth/csrf-token",{credentials:"include"})).json()).csrf_token}function k(){const[s,c]=o.useState({timings:[],holidays:[],isLoading:!0,error:null});o.useEffect(()=>{(async()=>{try{const e={"X-CSRFToken":await h(),"Content-Type":"application/json"},[a,i]=await Promise.all([fetch("/admin/api/timings",{headers:e,credentials:"include"}),fetch("/admin/api/holidays",{headers:e,credentials:"include"})]),l=await a.json(),u=await i.json();c({timings:l.status==="success"?l.market_status||[]:[],holidays:u.status==="success"?u.data||[]:[],isLoading:!1,error:null})}catch(t){c(e=>({...e,isLoading:!1,error:`Failed to fetch market status: ${t}`}))}})()},[]);const r=o.useCallback(n=>{const t=new Date().toISOString().split("T")[0],e=s.holidays.find(a=>a.date===t);if(!e)return!1;if(e.closed_exchanges.includes(n)){const a=e.open_exchanges.find(i=>i.exchange===n);if(a){const i=Date.now();return!(i>=a.start_time&&i<=a.end_time)}return!0}return!1},[s.holidays]),d=o.useCallback(n=>{if(r(n))return!1;const t=s.timings.find(a=>a.exchange===n);if(!t)return!1;const e=Date.now();return e>=t.start_time&&e<=t.end_time},[s.timings,r]),f=o.useCallback(()=>s.timings.some(n=>{const t=Date.now();return t>=n.start_time&&t<=n.end_time&&!r(n.exchange)}),[s.timings,r]),m=o.useCallback(n=>{if(r(n))return"closed";const t=s.timings.find(i=>i.exchange===n);if(!t)return"closed";const e=Date.now(),a=900*1e3;return e<t.start_time-a?"closed":e<t.start_time?"pre-market":e<=t.end_time?"open":"post-market"},[s.timings,r]);return{isMarketOpen:d,isAnyMarketOpen:f,isHolidayForExchange:r,getMarketStatus:m,timings:s.timings,holidays:s.holidays,isLoading:s.isLoading,error:s.error}}export{k as u};
